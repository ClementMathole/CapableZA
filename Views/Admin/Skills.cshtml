@model List<Capableza.Web.Models.Skill>
@using Capableza.Web.Models
@{
    ViewData["Title"] = "All Employee Skills";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<style>
    .header-actions .input-group-sm .form-control,
    .header-actions .input-group-sm .input-group-text { font-size: 0.8rem; border-radius: 0.375rem; }

    .skill-table-card { border: none; border-radius: 0.75rem; box-shadow: 0 .125rem .25rem rgba(0,0,0,.075); overflow: hidden; }
    .skill-table thead th {
        font-weight: 600; font-size: 0.8rem; text-transform: uppercase; letter-spacing: 0.5px;
        background-color: #0F6F84; color: white;
        border: none; padding: 0.75rem 1rem; vertical-align: middle;
    }
    .skill-table tbody td { vertical-align: middle; font-size: 0.9rem; border-top: 1px solid #dee2e6; padding: 0.75rem 1rem; }
    .skill-table tbody tr:first-child td { border-top: none; }

    .avatar-initials-sm {
        background-color: #e0f7fa; color: #0B5B6D; border-radius: 50%; display: inline-flex;
        align-items: center; justify-content: center; width: 30px; height: 30px;
        font-size: 0.8rem; font-weight: 600;
    }
    .employee-name { font-weight: 500; color: #343a40; margin-left: 0.75rem; }
    .badge { font-size: 0.75rem; padding: 0.3em 0.6em; font-weight: 500;}
    .btn-xs { padding: 0.15rem 0.5rem; font-size: 0.75rem; line-height: 1.4; }
    .action-icon { color: #6c757d; text-decoration: none; padding: 0.2rem; }
    .action-icon:hover { color: #0F6F84; }

</style>

<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-1 pb-2 mb-3 border-bottom">
    <h1 class="h2">@ViewData["Title"]</h1>
    <div class="d-flex align-items-center header-actions">
        <div class="input-group input-group-sm me-2 d-none d-md-flex" style="max-width: 300px;">
            <span class="input-group-text bg-light border-0 text-muted"><i class="fa fa-search"></i></span>
            <input type="text" id="skillSearchInput" class="form-control form-control-sm bg-light border-0" placeholder="Search employee, skill, or category...">
        </div>
    </div>
</div>

@if (!Model.Any())
{
    <div class="card shadow-sm">
        <div class="card-body text-center text-muted py-5">
             <i class="fa fa-lightbulb fa-3x mb-3 text-secondary"></i>
            <p>No skills have been recorded by any employees yet.</p>
        </div>
    </div>
}
else
{
    <div class="card skill-table-card shadow-sm">
        <div class="table-responsive">
            <table class="table skill-table mb-0 align-middle table-hover">
                <thead>
                    <tr>
                        <th style="width: 25%;">Employee</th>
                        <th style="width: 25%;">Skill</th>
                        <th style="width: 20%;">Category</th>
                        <th style="width: 15%;" class="text-center">Proficiency</th>
                        <th style="width: 10%;">Date</th>
                        <th style="width: 5%;" class="text-center">Actions</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in Model)
                    {
                        string initials = string.Join("", item.EmployeeName.Split(' ').Where(s => !string.IsNullOrEmpty(s)).Select(s => s[0])).ToUpper();
                        if (initials.Length > 2) initials = initials.Substring(0, 2);
                        else if (initials.Length == 0) initials = "??";

                        <tr class="skill-table-row">
                            <td>
                                <div class="d-flex align-items-center">
                                    <div class="avatar-initials-sm me-2"> @initials </div>
                                    <span class="employee-name">@item.EmployeeName</span>
                                </div>
                            </td>
                            <td class="fw-medium">@item.SkillName</td>
                            <td>@item.Category</td>
                            <td class="text-center">
                                <span class="badge bg-info-subtle text-info-emphasis rounded-pill">@item.Proficiency%</span>
                            </td>
                            <td class="text-muted small">@item.DateAcquired</td>
                            <td class="text-center">
                                <a asp-action="EmployeeDetails" asp-route-id="@item.EmployeeId" class="action-icon" title="View Employee Details">
                                    <i class="fa fa-user fa-fw"></i>
                                </a>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
}


@section Scripts {
    <script>
        $(document).ready(function() {
            $('#skillSearchInput').on('keyup', function() {
                var value = $(this).val().toLowerCase().trim();
                $('.skill-table-row').filter(function() {
                    $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
                });
            });
        });
    </script>
}