@model Capableza.Web.Models.Report
@{
    ViewData["Title"] = "Report Details";
    Layout = "~/Views/Shared/_Layout.cshtml"; 
}

<style>
    .card {
        border: none;
        border-radius: 0.75rem;
        box-shadow: 0 .125rem .25rem rgba(0,0,0,.075);
    }

    .card-header {
        background-color: #f8f9fa;
        border-bottom: 1px solid #dee2e6;
        font-weight: 600;
        color: #495057;
    }

    .card-title {
        font-size: 1rem;
        font-weight: 600;
        color: #343a40;
    }

    .details-label {
        font-weight: 500;
        color: #6c757d;
        font-size: 0.9rem;
    }

    .btn-primary-teal {
        background-color: #0F6F84;
        border-color: #0F6F84;
        color: white;
    }

        .btn-primary-teal:hover {
            background-color: #0B5B6D;
            border-color: #0B5B6D;
        }
</style>

<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-1 pb-2 mb-3 border-bottom">
    <div>
        <h1 class="h2">@ViewData["Title"]</h1>
    </div>
    <div class="btn-toolbar mb-2 mb-md-0">
        <a asp-action="Reports" class="btn btn-sm btn-outline-secondary">
            <i class="fa fa-arrow-left me-1"></i> Back to Reports List
        </a>
    </div>
</div>

<div class="row g-4">
    <div class="col-md-4">
        <div class="card shadow-sm">
            <div class="card-header py-3">
                <h5 class="mb-0 card-title"><i class="fa fa-info-circle me-2 text-primary" style="color: #0F6F84 !important;"></i> Metadata</h5>
            </div>
            <div class="card-body">
                <dl class="row">
                    <dt class="col-5 details-label">Report Type:</dt>
                    <dd class="col-7">@Model.ReportType</dd>

                    <dt class="col-5 details-label">Generated On:</dt>
                    <dd class="col-7">@Model.CreatedAtDateTime.ToString("yyyy-MM-dd HH:mm")</dd>

                    <dt class="col-5 details-label">Date Range:</dt>
                    <dd class="col-7">@Model.DateRange</dd>

                    <dt class="col-5 details-label">Role Filter:</dt>
                    <dd class="col-7">@Model.PositionOrRole</dd>
                </dl>
                <hr>
                <div class="d-grid gap-2">
                    <a href="@Model.FileUrl" download="@($"Report_{Model.ReportType.Replace(" ", "_")}_{Model.CreatedAtDateTime.ToString("yyyyMMdd")}.pdf")"
                       class="btn btn-primary-teal">
                        <i class="fa fa-download me-2"></i> Download PDF
                    </a>
                </div>
            </div>
        </div>
    </div>

    <div class="col-md-8">
        <div class="card shadow-sm">
            <div class="card-header py-3">
                <h5 class="mb-0 card-title"><i class="fa fa-file-pdf me-2 text-danger"></i> Report</h5>
            </div>
            <div class="card-body p-2" style="min-height: 800px;">
                @if (string.IsNullOrEmpty(Model.FileUrl))
                {
                    <div class="alert alert-danger m-3">No file URL is associated with this report record.</div>
                }
                else
                {
                    <iframe src="@Url.Action("ViewReport", "Admin", new { id = Model.Id })"
                            style="width: 100%; height: 800px; border: none;"
                            aria-label="PDF report viewer">
                        <p>Your browser does not support inline PDFs. <a href="@Model.FileUrl" download>Download the PDF instead</a>.</p>
                    </iframe>
                }
            </div>
        </div>
    </div>
</div>